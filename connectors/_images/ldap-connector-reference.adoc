= LDAP Connector Reference



== Configurations
---
[[config]]
=== Configuration


==== Parameters

[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|===
| Name | Type | Description | Default Value | Required
|Name | String | The name for this configuration. Connectors reference the configuration with this name. | | x
| Connection a| * <<config_basic, Basic Configuration>>
* <<config_tls, TLS Configuration>>
 | The connection types that can be provided to this configuration. | | x
| Expiration Policy a| <<ExpirationPolicy>> |  Configures the minimum amount of time that a dynamic configuration instance can remain idle before the runtime considers it eligible for expiration. This does not mean that the platform will expire the instance at the exact moment that it becomes eligible. The runtime will actually purge the instances when it sees it fit. |  |
|===

==== Connection Types
[[config_basic]]
===== Basic Configuration


====== Parameters

[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|===
| Name | Type | Description | Default Value | Required
| Principal DN a| String |  |  | x
| Password a| String |  |  |
| Authentication a| String |  |  |
| URL a| String |  |  | x
| Reconnection a| <<Reconnection>> |  When the application is deployed, a connectivity test is performed on all connectors. If set to true, deployment will fail if the test doesn't pass after exhausting the associated reconnection strategy |  |
| Type a| Enumeration, one of:

** JNDI |  The implementation of the connection to be used. |  JNDI |
| Schema Enabled a| Boolean |  If set to true, the LDAP connector will use the LDAP schema (only works for LDAP v3) to define the structure of the LDAP entry (or map). This needs to be 'true' in order to use DataSense as it will affect the implementing class of org.mule.module.ldap.api.LDAPEntry attributes. |  false |
| Referral a| Enumeration, one of:

** IGNORE
** THROW
** FOLLOW |  Constant that holds the name of the environment property for specifying how referrals encountered by the service provider are to be processed (follow, ignore, throw). |  IGNORE |
| Extended Configuration a| Object |  This is a Map instance holding extended configuration attributes that will be used in the Context environment. When working with TLS connections you need to make sure that the native LDAP pooling functionality is turned off. For example if using JNDI do not use attributes such as 'com.sun.jndi.ldap.connect.pool=true' will cause problems when using TLS. |  |
| Initial Pool Size a| Number |  The string representation of an integer that represents the number of connections per connection identity to create when initially creating a connection for the identity. To disable pooling, just set this value to 0 (zero). |  1 |
| Max Pool Size a| Number |  The string representation of an integer that represents the maximum number of connections per connection identity that can be maintained concurrently. |  5 |
| Pool Timeout a| Number |  The string representation of an integer that represents the number of milliseconds that an idle connection may remain in the pool without being closed and removed from the pool. |  60000 |
|===
[[config_tls]]
===== TLS Configuration


====== Parameters

[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|===
| Name | Type | Description | Default Value | Required
| Principal DN a| String |  |  | x
| Password a| String |  |  |
| Authentication a| String |  |  |
| URL a| String |  |  | x
| Reconnection a| <<Reconnection>> |  When the application is deployed, a connectivity test is performed on all connectors. If set to true, deployment will fail if the test doesn't pass after exhausting the associated reconnection strategy |  |
| Type a| Enumeration, one of:

** JNDI |  The implementation of the connection to be used. |  JNDI |
| Schema Enabled a| Boolean |  If set to true, the LDAP connector will use the LDAP schema (only works for LDAP v3) to define the structure of the LDAP entry (or map). This needs to be 'true' in order to use DataSense as it will affect the implementing class of org.mule.module.ldap.api.LDAPEntry attributes. |  false |
| Referral a| Enumeration, one of:

** IGNORE
** THROW
** FOLLOW |  Constant that holds the name of the environment property for specifying how referrals encountered by the service provider are to be processed (follow, ignore, throw). |  IGNORE |
| Extended Configuration a| Object |  This is a Map instance holding extended configuration attributes that will be used in the Context environment. When working with TLS connections you need to make sure that the native LDAP pooling functionality is turned off. For example if using JNDI do not use attributes such as 'com.sun.jndi.ldap.connect.pool=true' will cause problems when using TLS. |  |
|===

==== Associated Operations

* <<add>>
* <<addMultiValueAttribute>>
* <<addSingleValueAttribute>>
* <<bind>>
* <<delete>>
* <<deleteMultiValueAttribute>>
* <<deleteSingleValueAttribute>>
* <<exists>>
* <<ldapEntryToLdif>>
* <<lookup>>
* <<modify>>
* <<modifyMultiValueAttribute>>
* <<modifySingleValueAttribute>>
* <<pagedResultSearch>>
* <<rename>>
* <<search>>
* <<searchOne>>
* <<unbind>>



== Operations

[[add]]
== Add entry

`<ldap:add>`


Creates a new LDAPEntry in the LDAP server. The entry should contain the distinguished name (DN), the objectClass attributes that define its structure and at least a value for all the required attributes (required attributes depend on the object classes assigned to the entry. You can refer to RFC 4519 for standard object classes and attributes.


=== Parameters

[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | The name of the configuration to use. | | x
| Entry a| Object |  The LDAPEntry that should be added. |  #[payload] |
| Structural Object Class a| String |  The type of entry that will be added. If the entry doesn't have the objectClass attribute set, then this one will be used to retrieved the whole objectClass hierarchy. If performance is a requirement, don't rely on this functionality as several calls to the LDAP server will be done to trasverse the object class hierarchy. |  |
| Reconnection Strategy a| * <<reconnect>>
* <<reconnect-forever>> |  A retry strategy in case of connectivity errors |  |
|===


=== For Configurations

* <<config>>

=== Throws

* LDAP:NAME_NOT_FOUND
* LDAP:INVALID_ATTRIBUTE
* LDAP:RETRY_EXHAUSTED
* LDAP:CONTEXT_NOT_EMPTY
* LDAP:UNKNOWN
* LDAP:OPERATION_NOT_SUPPORTED
* LDAP:CONNECTIVITY
* LDAP:NAME_ALREADY_BOUND
* LDAP:INVALID_ENTRY
* LDAP:CONNECTIVITY
* LDAP:COMMUNICATION
* LDAP:PERMISSION


[[addMultiValueAttribute]]
== Add Multi Value Attribute


`<ldap:add-multi-value-attribute>`


Adds all the values for an attribute in an existing LDAP entry. If the entry already contained a value (or values) for the given attributeName then these values will be added. The attribute should allow multiple values or an exception will be raised.


=== Parameters

[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | The name of the configuration to use. | | x
| DN a| String |  The DN of the LDAP entry to modify |  | x
| Attribute Name a| String |  The name of the attribute to add values to. |  | x
| Attribute Values a| Array of Any |  The values for the attribute |  #[payload] |
| Ignore Invalid Attribute a| Boolean |  If the attribute value to add is already present, then don't throw INVALID_ATTRIBUTE error |  false |
| Reconnection Strategy a| * <<reconnect>>
* <<reconnect-forever>> |  A retry strategy in case of connectivity errors |  |
|===


=== For Configurations

* <<config>>

=== Throws

* LDAP:NAME_NOT_FOUND
* LDAP:INVALID_ATTRIBUTE
* LDAP:RETRY_EXHAUSTED
* LDAP:CONTEXT_NOT_EMPTY
* LDAP:UNKNOWN
* LDAP:OPERATION_NOT_SUPPORTED
* LDAP:CONNECTIVITY
* LDAP:NAME_ALREADY_BOUND
* LDAP:INVALID_ENTRY
* LDAP:CONNECTIVITY
* LDAP:COMMUNICATION
* LDAP:PERMISSION


[[addSingleValueAttribute]]
== Add Single Value Attribute

`<ldap:add-single-value-attribute>`


Adds a value for an attribute in an existing LDAP entry. If the entry already contained a value for the given attributeName then this value will be added (only if the attribute is multi value and there entry didn't have the value already). If you want to add a value with a type different than String, then you can use the add-multi-value-attribute operation and define a one element list with the value.


=== Parameters

[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | The name of the configuration to use. | | x
| DN a| String |  The DN of the LDAP entry to modify |  | x
| Attribute Name a| String |  The name of the attribute to add a value to. |  | x
| Attribute Value a| String |  The value for the attribute |  | x
| Ignore Invalid Attribute a| Boolean |  If the attribute value to add is already present, then don't throw InvalidAttributeException |  false |
| Reconnection Strategy a| * <<reconnect>>
* <<reconnect-forever>> |  A retry strategy in case of connectivity errors |  |
|===


=== For Configurations

* <<config>>

=== Throws

* LDAP:NAME_NOT_FOUND
* LDAP:INVALID_ATTRIBUTE
* LDAP:RETRY_EXHAUSTED
* LDAP:CONTEXT_NOT_EMPTY
* LDAP:UNKNOWN
* LDAP:OPERATION_NOT_SUPPORTED
* LDAP:CONNECTIVITY
* LDAP:NAME_ALREADY_BOUND
* LDAP:INVALID_ENTRY
* LDAP:CONNECTIVITY
* LDAP:COMMUNICATION
* LDAP:PERMISSION


[[bind]]
== Bind

`<ldap:bind>`


Performs an LDAP bind (login) operation. After login there will be a LDAP connection pool ready to use for other operations using the authenticated user. If no values are provided to override authDn and authPassword then using this operation will just re-bind (re-authenticate) the user/password defined in the config element. If new values are provided for authDn and authPassword, then authentication will be performed. <h4>Re-authenticating and returning the LDAP entry using config level credentials (authDn & authPassword)</h4>


=== Parameters

[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | The name of the configuration to use. | | x
| Principal DN a| String |  The Principal DN of the user |  |
| Password a| String |  The Password for Principal DN |  |
| Authentication a| String |  The type of authentication |  |
| Target Variable a| String |  The name of a variable on which the operation's output will be placed |  |
| Target Value a| String |  An expression that will be evaluated against the operation's output and the outcome of that expression will be stored in the target variable |  #[payload] |
| Reconnection Strategy a| * <<reconnect>>
* <<reconnect-forever>> |  A retry strategy in case of connectivity errors |  |
|===

=== Output

[cols=".^50%,.^50%"]
|===
| Type a| Object
|===

=== For Configurations

* <<config>>

=== Throws

* LDAP:NAME_NOT_FOUND
* LDAP:INVALID_ATTRIBUTE
* LDAP:RETRY_EXHAUSTED
* LDAP:CONTEXT_NOT_EMPTY
* LDAP:UNKNOWN
* LDAP:OPERATION_NOT_SUPPORTED
* LDAP:CONNECTIVITY
* LDAP:NAME_ALREADY_BOUND
* LDAP:INVALID_ENTRY
* LDAP:CONNECTIVITY
* LDAP:COMMUNICATION
* LDAP:PERMISSION


[[delete]]
== Delete entry

`<ldap:delete>`


Deletes the LDAP entry represented by the provided distinguished name. The entry should not have child entries, in which case a CONTEXT_NOT_EMPTY error is thrown. This operation is idempotent. It succeeds even if the terminal atomic name is not bound in the target context, but throws NAME_NOT_FOUND error if any of the intermediate contexts do not exist.


=== Parameters

[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | The name of the configuration to use. | | x
| DN a| String |  The DN of the LDAP entry to delete |  | x
| Reconnection Strategy a| * <<reconnect>>
* <<reconnect-forever>> |  A retry strategy in case of connectivity errors |  |
|===


=== For Configurations

* <<config>>

=== Throws

* LDAP:NAME_NOT_FOUND
* LDAP:INVALID_ATTRIBUTE
* LDAP:RETRY_EXHAUSTED
* LDAP:CONTEXT_NOT_EMPTY
* LDAP:UNKNOWN
* LDAP:OPERATION_NOT_SUPPORTED
* LDAP:CONNECTIVITY
* LDAP:NAME_ALREADY_BOUND
* LDAP:INVALID_ENTRY
* LDAP:CONNECTIVITY
* LDAP:COMMUNICATION
* LDAP:PERMISSION


[[deleteMultiValueAttribute]]
== Delete Multi Value Attribute

`<ldap:delete-multi-value-attribute>`


Deletes all the values matching attributeValues of the attribute defined by attributeName. Values that are not present in the entry are ignored. If no values are specified, then the whole attribute is deleted from the entry.


=== Parameters

[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | The name of the configuration to use. | | x
| DN a| String |  The DN of the LDAP entry to modify |  | x
| Attribute Name a| String |  The name of the attribute to delete its values. |  | x
| Attribute Values a| Array of Any |  The values that should be deleted. |  #[payload] |
| Ignore Invalid Attribute a| Boolean |  If the attribute or value to delete is not present, then don't throw INVALID_ATTRIBUTE error |  false |
| Reconnection Strategy a| * <<reconnect>>
* <<reconnect-forever>> |  A retry strategy in case of connectivity errors |  |
|===


=== For Configurations

* <<config>>

=== Throws

* LDAP:NAME_NOT_FOUND
* LDAP:INVALID_ATTRIBUTE
* LDAP:RETRY_EXHAUSTED
* LDAP:CONTEXT_NOT_EMPTY
* LDAP:UNKNOWN
* LDAP:OPERATION_NOT_SUPPORTED
* LDAP:CONNECTIVITY
* LDAP:NAME_ALREADY_BOUND
* LDAP:INVALID_ENTRY
* LDAP:CONNECTIVITY
* LDAP:COMMUNICATION
* LDAP:PERMISSION


[[deleteSingleValueAttribute]]
== Delete Single Value Attribute

`<ldap:delete-single-value-attribute>`


Deletes the value matching attributeValue of the attribute defined by attributeName. If the entry didn't have the value, then the entry stays the same. If no value is specified, then the whole attribute is deleted from the entry. If you want to delete a value with a type different than String, then you can use the delete-multi-value-attribute operation and define a one element list with the value.


=== Parameters

[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | The name of the configuration to use. | | x
| DN a| String |  The DN of the LDAP entry to modify |  | x
| Attribute Name a| String |  The name of the attribute to delete its value. |  | x
| Attribute Value a| String |  The value that should be deleted. |  |
| Ignore Invalid Attribute a| Boolean |  If the attribute or value to delete is not present, then don't throw INVALID_ATTRIBUTE error |  false |
| Reconnection Strategy a| * <<reconnect>>
* <<reconnect-forever>> |  A retry strategy in case of connectivity errors |  |
|===


=== For Configurations

* <<config>>

=== Throws

* LDAP:NAME_NOT_FOUND
* LDAP:INVALID_ATTRIBUTE
* LDAP:RETRY_EXHAUSTED
* LDAP:CONTEXT_NOT_EMPTY
* LDAP:UNKNOWN
* LDAP:OPERATION_NOT_SUPPORTED
* LDAP:CONNECTIVITY
* LDAP:NAME_ALREADY_BOUND
* LDAP:INVALID_ENTRY
* LDAP:CONNECTIVITY
* LDAP:COMMUNICATION
* LDAP:PERMISSION


[[exists]]
== Exists

`<ldap:exists>`


Checks whether an LDAP entry exists in the LDAP server or not.


=== Parameters

[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | The name of the configuration to use. | | x
| DN a| String |  The DN of the LDAP entry that will be retrieved. |  | x
| Target Variable a| String |  The name of a variable on which the operation's output will be placed |  |
| Target Value a| String |  An expression that will be evaluated against the operation's output and the outcome of that expression will be stored in the target variable |  #[payload] |
| Reconnection Strategy a| * <<reconnect>>
* <<reconnect-forever>> |  A retry strategy in case of connectivity errors |  |
|===

=== Output

[cols=".^50%,.^50%"]
|===
| Type a| Boolean
|===

=== For Configurations

* <<config>>

=== Throws

* LDAP:NAME_NOT_FOUND
* LDAP:INVALID_ATTRIBUTE
* LDAP:RETRY_EXHAUSTED
* LDAP:CONTEXT_NOT_EMPTY
* LDAP:UNKNOWN
* LDAP:OPERATION_NOT_SUPPORTED
* LDAP:CONNECTIVITY
* LDAP:NAME_ALREADY_BOUND
* LDAP:INVALID_ENTRY
* LDAP:CONNECTIVITY
* LDAP:COMMUNICATION
* LDAP:PERMISSION


[[ldapEntryToLdif]]
== Ldap Entry To Ldif

`<ldap:ldap-entry-to-ldif>`


Transforms a LDAPEntry to a String in LDIF representation (RFC 2849).


=== Parameters

[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | The name of the configuration to use. | | x
| Entry a| Object |  The LDAPEntry to transform to LDIF. |  #[payload] |
| Target Variable a| String |  The name of a variable on which the operation's output will be placed |  |
| Target Value a| String |  An expression that will be evaluated against the operation's output and the outcome of that expression will be stored in the target variable |  #[payload] |
| Reconnection Strategy a| * <<reconnect>>
* <<reconnect-forever>> |  A retry strategy in case of connectivity errors |  |
|===

=== Output

[cols=".^50%,.^50%"]
|===
| Type a| String
|===

=== For Configurations

* <<config>>

=== Throws

* LDAP:NAME_NOT_FOUND
* LDAP:INVALID_ATTRIBUTE
* LDAP:RETRY_EXHAUSTED
* LDAP:CONTEXT_NOT_EMPTY
* LDAP:UNKNOWN
* LDAP:OPERATION_NOT_SUPPORTED
* LDAP:CONNECTIVITY
* LDAP:NAME_ALREADY_BOUND
* LDAP:INVALID_ENTRY
* LDAP:CONNECTIVITY
* LDAP:COMMUNICATION
* LDAP:PERMISSION


[[lookup]]
== Lookup

`<ldap:lookup>`


Retrieves an entry from the LDAP server base on its distinguished name (DN). DNs are the unique identifiers of an LDAP entry, so this method will perform a search based on this ID and so return a single entry as result or throw an exception if the DN is invalid or inexistent. Use this operation over #searchOne(LDAPConfiguration, LDAPConnectionWrapper, String, String, List, SearchScope, int, long, boolean, String) when you know the DN of the object you want to retrieve. <p/>


=== Parameters

[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | The name of the configuration to use. | | x
| DN a| String |  The DN of the LDAP entry that will be retrieved. |  | x
| Attributes a| Array of String |  A list of the attributes that should be returned in the result. If the attributes list is empty or null, then by default all LDAP entry attributes are returned. |  |
| Structural Object Class a| String |  The type of entry that will be returned. Only for DataSense purposes to be used in Anypoint Studio IDE. Has no impact on runtime, that's why it is optional. |  |
| Target Variable a| String |  The name of a variable on which the operation's output will be placed |  |
| Target Value a| String |  An expression that will be evaluated against the operation's output and the outcome of that expression will be stored in the target variable |  #[payload] |
| Reconnection Strategy a| * <<reconnect>>
* <<reconnect-forever>> |  A retry strategy in case of connectivity errors |  |
|===

=== Output

[cols=".^50%,.^50%"]
|===
| Type a| Object
|===

=== For Configurations

* <<config>>

=== Throws

* LDAP:NAME_NOT_FOUND
* LDAP:INVALID_ATTRIBUTE
* LDAP:RETRY_EXHAUSTED
* LDAP:CONTEXT_NOT_EMPTY
* LDAP:UNKNOWN
* LDAP:OPERATION_NOT_SUPPORTED
* LDAP:CONNECTIVITY
* LDAP:NAME_ALREADY_BOUND
* LDAP:INVALID_ENTRY
* LDAP:CONNECTIVITY
* LDAP:COMMUNICATION
* LDAP:PERMISSION


[[modify]]
== Modify entry

`<ldap:modify>`


Updates an existing LDAPEntry in the LDAP server. The entry should contain an existing distinguished name (DN), and at least a value for all the required attributes (required attributes depend on the object classes assigned to the entry. You can refer to RFC 4519 for standard object classes and attributes. When updating a LDAP entry, only the attributes in the entry passed as parameter are updated or added. If you need to delete an attribute, you should use the delete attribute operation.  Example: Updating one attribute and adding one.

Original LDAP server entry:

[source,xml,linenums]
----
dn: cn=entry,ou=group,dc=company,dc=org
cn: entry
attr1: Value1
attr2: Value2
multi1: Value3
multi1: Value4
objectclass: top
objectclass: myentry
----

Entry map passed as a parameter:

[source,xml,linenums]
----
dn: cn=entry,ou=group,dc=company,dc=org
attr1: NewValue
attr3: NewAttributeValue </code> 
----

Resulting LDAP server entry:

[source,xml,linenums]
----
dn: cn=entry,ou=group,dc=company,dc=org
cn: entry
attr1: NewValue
attr2: Value2
multi1: Value3
multi1: Value4
attr3: NewAttributeValue
objectclass: top
objectclass: myentry
----

=== Parameters

[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | The name of the configuration to use. | | x
| Entry a| Object |  The LDAPEntry that should be updated. |  #[payload] |
| Structural Object Class a| String |  The type of entry that will be updated. Only for DataSense purposes to be used in Anypoint Studio IDE. Has no impact on runtime, that's why it is optional. |  |
| Reconnection Strategy a| * <<reconnect>>
* <<reconnect-forever>> |  A retry strategy in case of connectivity errors |  |
|===


=== For Configurations

* <<config>>

=== Throws

* LDAP:NAME_NOT_FOUND
* LDAP:INVALID_ATTRIBUTE
* LDAP:RETRY_EXHAUSTED
* LDAP:CONTEXT_NOT_EMPTY
* LDAP:UNKNOWN
* LDAP:OPERATION_NOT_SUPPORTED
* LDAP:CONNECTIVITY
* LDAP:NAME_ALREADY_BOUND
* LDAP:INVALID_ENTRY
* LDAP:CONNECTIVITY
* LDAP:COMMUNICATION
* LDAP:PERMISSION


[[modifyMultiValueAttribute]]
== Modify Multi Value Attribute

`<ldap:modify-multi-value-attribute>`


Updates (replaces) the value or values of the attribute defined by attributeName with the new values defined by attributeValues. If the attribute was not present in the entry, then the value is added.


=== Parameters

[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | The name of the configuration to use. | | x
| DN a| String |  The DN of the LDAP entry to modify |  | x
| Attribute Name a| String |  The name of the attribute to update its values. |  | x
| Attribute Values a| Array of Any |  The new values for the attribute |  #[payload] |
| Ignore Invalid Attribute a| Boolean |  If the attribute value to modify is already present, then don't throw INVALID_ATTRIBUTE error |  false |
| Reconnection Strategy a| * <<reconnect>>
* <<reconnect-forever>> |  A retry strategy in case of connectivity errors |  |
|===


=== For Configurations

* <<config>>

=== Throws

* LDAP:NAME_NOT_FOUND
* LDAP:INVALID_ATTRIBUTE
* LDAP:RETRY_EXHAUSTED
* LDAP:CONTEXT_NOT_EMPTY
* LDAP:UNKNOWN
* LDAP:OPERATION_NOT_SUPPORTED
* LDAP:CONNECTIVITY
* LDAP:NAME_ALREADY_BOUND
* LDAP:INVALID_ENTRY
* LDAP:CONNECTIVITY
* LDAP:COMMUNICATION
* LDAP:PERMISSION


[[modifySingleValueAttribute]]
== Modify Single Value Attribute

`<ldap:modify-single-value-attribute>`


Updates (replaces) the value or values of the attribute defined by attributeName with the new value defined by attributeValue. If the attribute was not present in the entry, then the value is added. If you want to update a value with a type different than String, then you can use the update-multi-value-attribute operation and define a one element list with the value.


=== Parameters

[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | The name of the configuration to use. | | x
| DN a| String |  The DN of the LDAP entry to modify |  | x
| Attribute Name a| String |  The name of the attribute to update its value. |  | x
| Attribute Value a| String |  The new value for the attribute |  | x
| Ignore Invalid Attribute a| Boolean |  If the attribute value to modify is already present, then don't throw INVALID_ATTRIBUTE error |  false |
| Reconnection Strategy a| * <<reconnect>>
* <<reconnect-forever>> |  A retry strategy in case of connectivity errors |  |
|===


=== For Configurations

* <<config>>

=== Throws

* LDAP:NAME_NOT_FOUND
* LDAP:INVALID_ATTRIBUTE
* LDAP:RETRY_EXHAUSTED
* LDAP:CONTEXT_NOT_EMPTY
* LDAP:UNKNOWN
* LDAP:OPERATION_NOT_SUPPORTED
* LDAP:CONNECTIVITY
* LDAP:NAME_ALREADY_BOUND
* LDAP:INVALID_ENTRY
* LDAP:CONNECTIVITY
* LDAP:COMMUNICATION
* LDAP:PERMISSION


[[pagedResultSearch]]
== Paged Result Search

`<ldap:paged-result-search>`


Performs a LDAP search and streams result to the rest of the flow. 

This means that instead of returning a list with all results it partitions the LDAP search result into pages (individual entry if resultPageSize is 1) or lists of size resultPageSize. 

This is an  intercepting operation what means that for each result (individual entry if resultPageSize is 1 or List of resultPageSize size) the rest of the flow will be executed. Each of these executions will return a result that will be aggregated into a List of results. For queries returning large results it is recommended to use pagination (not all LDAP servers support this or are configured to support it). 

For that you need to provide a fetch size (page size) value that should be less or equal than max results (count limit). If you are getting a Size Limit Exceeded exception message then you should check that the authenticated user has enough privileges or the LDAP server is not limited by configuration. In that case, just reduce the value of the fetch size. <p/>


=== Parameters

[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | The name of the configuration to use. | | x
| Base DN a| String |  The base DN of the LDAP search. |  | x
| Filter a| String |  A valid LDAP filter. The LDAP connector supports LDAP search filters as defined in RFC 2254. |  | x
| Attributes a| Array of String |  A list of the attributes that should be returned in the result. If the attributes list is empty or null, then by default all LDAP entry attributes are returned. |  |
| Scope a| Enumeration, one of:

** OBJECT
** ONE_LEVEL
** SUB_TREE |  The scope of the search. Valid attributes are: 

* OBJECT: This value is used to indicate searching only the entry at the base DN, resulting in only that entry being returned (keeping in mind that it also has to meet the search filter criteria!) 
* ONE_LEVEL: This value is used to indicate searching all entries one level under the base DN - but not including the base DN and not including any entries under that one level under the base DN. 
* SUB_TREE: This value is used to indicate searching of all entries at all levels under and including the specified base DN. |  ONE_LEVEL |
| Timeout a| Number |  Search timeout in milliseconds. If the value is 0, this means to wait indefinitely. |  0 |
| Max Results a| Number |  The maximum number of entries that will be returned as a result of the search. 0 indicates that all entries will be returned. |  0 |
| Return Object a| Boolean |  Enables/disables returning objects returned as part of the result. If disabled, only the name and class of the object is returned. If enabled, the object will be returned. |  false |
| Page Size a| Number |  If the LDAP server supports paging results set in this attribute the size of the page. If the pageSize is less or equals than 0, then paging will be disabled. |  0 |
| Order by attribute a| String |  Name of the LDAP attribute used to sort results. |  |
| Ascending order? a| Boolean |  If orderBy was set, whether to sort in ascending or descending order. |  true |
| Structural Object Class a| String |  The type of entry that will be returned. Only for DataSense purposes to be used in Anypoint Studio IDE. Has no impact on runtime, that's why it is optional. |  |
| Fetch Size a| Number |  The maximum number of LDAP entries retrieved at once per page |  200 |
| Streaming Strategy a| * <<repeatable-in-memory-iterable>>
* <<repeatable-file-store-iterable>>
* <<non-repeatable-iterable>> |  Configure if repeatable streams should be used and their behavior |  |
| Target Variable a| String |  The name of a variable on which the operation's output will be placed |  |
| Target Value a| String |  An expression that will be evaluated against the operation's output and the outcome of that expression will be stored in the target variable |  #[payload] |
| Reconnection Strategy a| * <<reconnect>>
* <<reconnect-forever>> |  A retry strategy in case of connectivity errors |  |
|===

=== Output

[cols=".^50%,.^50%"]
|===
| Type a| Array of Object
|===

=== For Configurations

* <<config>>

=== Throws

* LDAP:NAME_NOT_FOUND
* LDAP:INVALID_ATTRIBUTE
* LDAP:CONTEXT_NOT_EMPTY
* LDAP:UNKNOWN
* LDAP:OPERATION_NOT_SUPPORTED
* LDAP:NAME_ALREADY_BOUND
* LDAP:INVALID_ENTRY
* LDAP:CONNECTIVITY
* LDAP:COMMUNICATION
* LDAP:PERMISSION


[[rename]]
== Rename entry

`<ldap:rename>`


Renames an existing LDAP entry (moves an entry from a DN to another one).


==== Parameters

[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | The name of the configuration to use. | | x
| Current DN a| String |  DN of the existing entry that will be renamed. |  | x
| New DN a| String |  Destination DN |  | x
| Reconnection Strategy a| * <<reconnect>>
* <<reconnect-forever>> |  A retry strategy in case of connectivity errors |  |
|===


=== For Configurations

* <<config>>

=== Throws

* LDAP:NAME_NOT_FOUND
* LDAP:INVALID_ATTRIBUTE
* LDAP:RETRY_EXHAUSTED
* LDAP:CONTEXT_NOT_EMPTY
* LDAP:UNKNOWN
* LDAP:OPERATION_NOT_SUPPORTED
* LDAP:CONNECTIVITY
* LDAP:NAME_ALREADY_BOUND
* LDAP:INVALID_ENTRY
* LDAP:CONNECTIVITY
* LDAP:COMMUNICATION
* LDAP:PERMISSION


[[search]]
== Search

`<ldap:search>`


Performs a LDAP search returning a list with all the resulting LDAP entries. For queries returning large results it is recommended to use pagination (not all LDAP servers support this or are configured to support it). For that you need to provide a page size value that should be less or equal than max results (count limit). If you are getting a Sizelimit Exceeded exception then you should check that the authenticated user has enough privileges or the LDAP server is not limited by configuration.


=== Parameters

[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | The name of the configuration to use. | | x
| Base DN a| String |  The base DN of the LDAP search. |  | x
| Filter a| String |  A valid LDAP filter. The LDAP connector supports LDAP search filters as defined in RFC 2254. |  | x
| Attributes a| Array of String |  A list of the attributes that should be returned in the result. If the attributes list is empty or null, then by default all LDAP entry attributes are returned. |  |
| Scope a| Enumeration, one of:

** OBJECT
** ONE_LEVEL
** SUB_TREE |  The scope of the search. Valid attributes are: 

* OBJECT: This value is used to indicate searching only the entry at the base DN, resulting in only that entry being returned (keeping in mind that it also has to meet the search filter criteria)
* ONE_LEVEL: This value is used to indicate searching all entries one level under the base DN - but not including the base DN and not including any entries under that one level under the base DN.
* SUB_TREE: This value is used to indicate searching of all entries at all levels under and including the specified base DN. |  ONE_LEVEL |
| Timeout a| Number |  Search timeout in milliseconds. If the value is 0, this means to wait indefinitely. |  0 |
| Max Results a| Number |  The maximum number of entries that will be returned as a result of the search. 0 indicates that all entries will be returned. |  0 |
| Return Object a| Boolean |  Enables/disables returning objects returned as part of the result. If disabled, only the name and class of the object is returned. If enabled, the object will be returned. |  false |
| Page Size a| Number |  If the LDAP server supports paging results set in this attribute the size of the page. If the pageSize is less or equals than 0, then paging will be disabled. |  0 |
| Structural Object Class a| String |  The type of entry that will be returned. Only for DataSense purposes to be used in Anypoint Studio IDE. Has no impact on runtime, that's why it is optional. |  |
| Target Variable a| String |  The name of a variable on which the operation's output will be placed |  |
| Target Value a| String |  An expression that will be evaluated against the operation's output and the outcome of that expression will be stored in the target variable |  #[payload] |
| Reconnection Strategy a| * <<reconnect>>
* <<reconnect-forever>> |  A retry strategy in case of connectivity errors |  |
|===

=== Output

[cols=".^50%,.^50%"]
|===
| Type a| Array of Object
|===

=== For Configurations

* <<config>>

=== Throws

* LDAP:NAME_NOT_FOUND
* LDAP:INVALID_ATTRIBUTE
* LDAP:RETRY_EXHAUSTED
* LDAP:CONTEXT_NOT_EMPTY
* LDAP:UNKNOWN
* LDAP:OPERATION_NOT_SUPPORTED
* LDAP:CONNECTIVITY
* LDAP:NAME_ALREADY_BOUND
* LDAP:INVALID_ENTRY
* LDAP:CONNECTIVITY
* LDAP:COMMUNICATION
* LDAP:PERMISSION


[[searchOne]]
== Search One

`<ldap:search-one>`


Performs a LDAP search that is supposed to return a unique result. If the search returns more than one result, then a warn log message is generated and the first element of the result is returned. Use this operation over #lookup(LDAPConfiguration, LDAPConnectionWrapper, String, List, String) when you know don't know the DN of the entry you need to retrieve but you have a set of attributes that you know should return a single entry (for example an email address)


=== Parameters

[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | The name of the configuration to use. | | x
| Base DN a| String |  The base DN of the LDAP search. |  | x
| Filter a| String |  A valid LDAP filter. The LDAP connector supports LDAP search filters as defined in RFC 2254. |  | x
| Attributes a| Array of String |  A list of the attributes that should be returned in the result. If the attributes list is empty or null, then by default all LDAP entry attributes are returned. |  |
| Scope a| Enumeration, one of:

** OBJECT
** ONE_LEVEL
** SUB_TREE |  The scope of the search. Valid attributes are: 

* OBJECT: This value is used to indicate searching only the entry at the base DN, resulting in only that entry being returned (keeping in mind that it also has to meet the search filter criteria!)
* ONE_LEVEL: This value is used to indicate searching all entries one level under the base DN - but not including the base DN and not including any entries under that one level under the base DN.
* SUB_TREE: This value is used to indicate searching of all entries at all levels under and including the specified base DN.
|  ONE_LEVEL |
| Timeout a| Number |  Search timeout in milliseconds. If the value is 0, this means to wait indefinitely. |  0 |
| Max Results a| Number |  The maximum number of entries that will be returned as a result of the search. 0 indicates that all entries will be returned. |  0 |
| Return Object a| Boolean |  Enables/disables returning objects returned as part of the result. If disabled, only the name and class of the object is returned. If enabled, the object will be returned. |  false |
| Structural Object Class a| String |  The type of entry that will be returned. Only for DataSense purposes to be used in Anypoint Studio IDE. Has no impact on runtime, that's why it is optional. |  |
| Target Variable a| String |  The name of a variable on which the operation's output will be placed |  |
| Target Value a| String |  An expression that will be evaluated against the operation's output and the outcome of that expression will be stored in the target variable |  #[payload] |
| Reconnection Strategy a| * <<reconnect>>
* <<reconnect-forever>> |  A retry strategy in case of connectivity errors |  |
|===

=== Output

[cols=".^50%,.^50%"]
|===
| Type a| Object
|===

=== For Configurations

* <<config>>

=== Throws

* LDAP:NAME_NOT_FOUND
* LDAP:INVALID_ATTRIBUTE
* LDAP:RETRY_EXHAUSTED
* LDAP:CONTEXT_NOT_EMPTY
* LDAP:UNKNOWN
* LDAP:OPERATION_NOT_SUPPORTED
* LDAP:CONNECTIVITY
* LDAP:NAME_ALREADY_BOUND
* LDAP:INVALID_ENTRY
* LDAP:CONNECTIVITY
* LDAP:COMMUNICATION
* LDAP:PERMISSION


[[unbind]]
== Unbind

`<ldap:unbind>`


Closes the current connection, forcing the login operation (bind) the next time it is used.


=== Parameters

[cols=".^20%,.^20%,.^35%,.^20%,^.^5%", options="header"]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | The name of the configuration to use. | | x
| Reconnection Strategy a| * <<reconnect>>
* <<reconnect-forever>> |  A retry strategy in case of connectivity errors |  |
|===


=== For Configurations

* <<config>>

=== Throws

* LDAP:NAME_NOT_FOUND
* LDAP:INVALID_ATTRIBUTE
* LDAP:RETRY_EXHAUSTED
* LDAP:CONTEXT_NOT_EMPTY
* LDAP:UNKNOWN
* LDAP:OPERATION_NOT_SUPPORTED
* LDAP:CONNECTIVITY
* LDAP:NAME_ALREADY_BOUND
* LDAP:INVALID_ENTRY
* LDAP:CONNECTIVITY
* LDAP:COMMUNICATION
* LDAP:PERMISSION



== Types
[[Reconnection]]
=== Reconnection

[cols=".^20%,.^25%,.^30%,.^15%,.^10%", options="header"]
|===
| Field | Type | Description | Default Value | Required
| Fails Deployment a| Boolean | When the application is deployed, a connectivity test is performed on all connectors. If set to true, deployment will fail if the test doesn't pass after exhausting the associated reconnection strategy |  | 
| Reconnection Strategy a| * <<reconnect>>
* <<reconnect-forever>> | The reconnection strategy to use |  | 
|===

[[reconnect]]
=== Reconnect

[cols=".^20%,.^25%,.^30%,.^15%,.^10%", options="header"]
|===
| Field | Type | Description | Default Value | Required
| Frequency a| Number | How often (in ms) to reconnect |  | 
| Count a| Number | How many reconnection attempts to make |  | 
|===

[[reconnect-forever]]
=== Reconnect Forever

[cols=".^20%,.^25%,.^30%,.^15%,.^10%", options="header"]
|===
| Field | Type | Description | Default Value | Required
| Frequency a| Number | How often (in ms) to reconnect |  | 
|===

[[ExpirationPolicy]]
=== Expiration Policy

[cols=".^20%,.^25%,.^30%,.^15%,.^10%", options="header"]
|===
| Field | Type | Description | Default Value | Required
| Max Idle Time a| Number | A scalar time value for the maximum amount of time a dynamic configuration instance should be allowed to be idle before it's considered eligible for expiration |  | 
| Time Unit a| Enumeration, one of:

** NANOSECONDS
** MICROSECONDS
** MILLISECONDS
** SECONDS
** MINUTES
** HOURS
** DAYS | A time unit that qualifies the maxIdleTime attribute |  | 
|===

[[repeatable-in-memory-iterable]]
=== Repeatable In Memory Iterable

[cols=".^20%,.^25%,.^30%,.^15%,.^10%", options="header"]
|===
| Field | Type | Description | Default Value | Required
| Initial Buffer Size a| Number | This is the amount of instances that will be initially be allowed to be kept in memory in order to consume the stream and provide random access to it. If the stream contains more data than can fit into this buffer, then it will be expanded according to the bufferSizeIncrement attribute, with an upper limit of maxInMemorySize. Default value is 100 instances. |  | 
| Buffer Size Increment a| Number | This is by how much will the buffer size by expanded if it exceeds its initial size. Setting a value of zero or lower will mean that the buffer should not expand, meaning that a STREAM_MAXIMUM_SIZE_EXCEEDED error will be raised when the buffer gets full. Default value is 100 instances. |  | 
| Max Buffer Size a| Number | This is the maximum amount of memory that will be used. If more than that is used then a STREAM_MAXIMUM_SIZE_EXCEEDED error will be raised. A value lower or equal to zero means no limit. |  | 
|===

[[repeatable-file-store-iterable]]
=== Repeatable File Store Iterable

[cols=".^20%,.^25%,.^30%,.^15%,.^10%", options="header"]
|===
| Field | Type | Description | Default Value | Required
| Max In Memory Size a| Number | This is the maximum amount of instances that will be kept in memory. If more than that is required, then it will start to buffer the content on disk. |  | 
| Buffer Unit a| Enumeration, one of:

** BYTE
** KB
** MB
** GB | The unit in which maxInMemorySize is expressed |  | 
|===

